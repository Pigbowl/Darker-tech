<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darker Tech</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/components.css">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>

<body class="bg-dark text-gray-100 font-inter min-h-screen flex flex-col bg-grid">
    <div id="particles-js"></div>
    
    <div class="content min-h-screen">
        <div id="navbar-container"></div>
        <main class="content">
            <!-- 主内容区 -->
            <div class="container mx-auto px-4 py-8">
                <!-- 页面标题区域 -->
                <section class="mt-14 mb-12 relative rounded bg-gradient-to-t from-light-blue/40 to-dark border-b border-primary/20 pb-10">
                    <div class="absolute inset-0 bg-grid opacity-50"></div>
                    <div class="relative z-10 max-w-4xl mx-auto text-center">
                        <h2 class="text-[clamp(1.8rem,5vw,3rem)] font-bold mb-4 text-white">
                            ADAS <span class="text-light-blue text-shadow-glow">对标数据库</span> 
                        </h2>
                        <p class="text-gray-300 text-lg mb-8 max-w-2xl mx-auto">
                            精准对比分析ADAS系统性能指标，为智能驾驶技术发展提供数据支持与决策参考
                        </p>
                        <div class="flex flex-col sm:flex-row gap-4 justify-center">
                            <div class="relative flex-grow max-w-md">
                                <input
                                    type="text" 
                                    placeholder="搜索ADAS产品、技术指标或厂商..."
                                    class="w-full bg-white/90 border border-primary/30 rounded-lg py-3 px-5 pr-12 focus:outline-none focus:border-primary transition-all duration-300 text-black"
                                >
                                <button class="absolute right-3 top-1/2 transform -translate-y-1/2 text-primary hover:text-white transition-colors">
                                    <i class="fa fa-search text-xl"></i>
                                </button>
                            </div>
                            <button class="px-6 py-3 bg-light-blue text-dark font-bold rounded-lg hover:bg-light-blue transition-all duration-300 flex items-center justify-center gap-2">
                                <i class="fa fa-rocket"></i> 开始分析
                            </button>
                        </div>
                    </div>
                    <!-- 装饰性元素 -->
                    <div class="absolute top-1/4 left-10 w-20 h-20 rounded-full bg-primary/20 blur-xl animate-float"></div>
                    <div class="absolute bottom-1/4 right-10 w-32 h-32 rounded-full bg-secondary/20 blur-xl animate-float" style="animation-delay: 1s"></div>
                </section>

                <!-- 筛选器区域 -->
                <section class="mb-10 bg-dark-light/80 glass-effect rounded-xl p-6 border border-primary/20">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
                        <h3 class="text-xl font-semibold text-white flex items-center gap-2"><i class="fa fa-filter text-white"></i> 筛选条件</h3>
                        <button class="text-sm text-primary hover:text-white transition-colors flex items-center gap-1">
                            <i class="fa fa-sliders"></i> 高级筛选
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="space-y-2">
                            <label class="text-sm text-gray-400">产品类型</label>
                            <select class="w-full bg-dark-light border border-gray-700 rounded-lg py-2 px-3 text-gray-200 focus:outline-none focus:border-primary transition-colors">
                                <option>全部类型</option>
                                <option>前视摄像头</option>
                                <option>激光雷达</option>
                                <option>毫米波雷达</option>
                                <option>域控制器</option>
                                <option>完整解决方案</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm text-gray-400">测试场景</label>
                            <select class="w-full bg-dark-light border border-gray-700 rounded-lg py-2 px-3 text-gray-200 focus:outline-none focus:border-primary transition-colors">
                                <option>全部场景</option>
                                <option>城市道路</option>
                                <option>高速公路</option>
                                <option>乡村道路</option>
                                <option>夜间环境</option>
                                <option>恶劣天气</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm text-gray-400">发布年份</label>
                            <select class="w-full bg-dark-light border border-gray-700 rounded-lg py-2 px-3 text-gray-200 focus:outline-none focus:border-primary transition-colors">
                                <option>全部年份</option>
                                <option>2023</option>
                                <option>2022</option>
                                <option>2021</option>
                                <option>2020</option>
                                <option>2019及以前</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-sm text-gray-400">排序方式</label>
                            <select class="w-full bg-dark-light border border-gray-700 rounded-lg py-2 px-3 text-gray-200 focus:outline-none focus:border-primary transition-colors">
                                <option>综合评分 (降序)</option>
                                <option>发布日期 (最新)</option>
                                <option>感知精度 (降序)</option>
                                <option>算力效率 (降序)</option>
                                <option>成本效益 (升序)</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-6 flex flex-wrap gap-3">
                        <span class="inline-flex items-center gap-2 px-3 py-1 bg-dark-light rounded-full text-sm border border-primary/30">
                            产品类型: 全部类型
                            <button class="text-gray-400 hover:text-primary"><i class="fa fa-times-circle"></i></button>
                        </span>
                        <span class="inline-flex items-center gap-2 px-3 py-1 bg-dark-light rounded-full text-sm border border-primary/30">
                            测试场景: 全部场景
                            <button class="text-gray-400 hover:text-primary"><i class="fa fa-times-circle"></i></button>
                        </span>
                        <button class="text-sm text-gray-400 hover:text-primary ml-auto flex items-center gap-1">
                            <i class="fa fa-refresh"></i> 清除全部筛选
                        </button>
                    </div>
                </section>

                <!-- 产品展示区域 -->
                <section id="products" class="mb-16">
                    <h3 class="text-2xl font-bold text-white mb-8 flex items-center gap-2">
                        <i class="fa fa-cubes text-primary"></i> ADAS产品基准测试
                    </h3>

                    <!-- 搜索和筛选 -->

                    <div class="flex flex-wrap gap-4 mb-8">             <!-- 搜索和筛选 -->
                        <div class="relative flex-1 min-w-[200px] max-w-md">
                            <input type="text" id="search-input" placeholder="搜索产品..." class="w-full py-3 px-4 pr-10 bg-dark rounded-lg border border-gray-700 focus:border-primary focus:outline-none text-white">
                            <button id="search-btn" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-primary">
                                <i class="fa fa-search"></i>
                            </button>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <select id="category-filter" class="py-3 px-4 bg-dark rounded-lg border border-gray-700 focus:border-primary focus:outline-none text-white">
                                <option value="all">所有类别</option>
                            </select>
                            <select id="brand-filter" class="py-3 px-4 bg-dark rounded-lg border border-gray-700 focus:border-primary focus:outline-none text-white">
                                <option value="all">所有品牌</option>
                            </select>
                        </div>
                    </div>
                    <!-- 加载更多按钮 -->
                    <div class="text-center mt-10">
                        <button id="load-more" class="px-8 py-3 border border-primary/50 text-primary hover:bg-primary/10 transition-all duration-300 rounded-lg inline-flex items-center gap-2 mb-6">
                            <i class="fa fa-refresh"></i> 显示更多产品
                        </button>
                    </div>

                    <!-- 产品卡片网格 - 初始为空 -->
                    <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                        <!-- 卡片将通过JavaScript动态生成 -->
                    </div>


                </section>

                <!-- 结果对比区域 -->
                <section id="comparison" class="mb-16 glass-effect rounded-xl p-6 border border-primary/20">
                    <h3 class="text-2xl font-bold text-white mb-8 flex items-center gap-2">
                        <i class="fa fa-bar-chart text-primary"></i> 性能基准对比分析
                    </h3>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-1">
                            <div class="bg-dark-light rounded-lg p-5 border border-gray-800 mb-6">
                                <h4 class="text-lg font-semibold text-white mb-4">选择对比产品</h4>
                                <div id="comparison-products" class="space-y-4">
                                    <!-- 初始添加框 -->
                                    <div class="flex items-center justify-center p-6 bg-dark rounded-lg border border-dashed border-gray-700 hover:border-primary/50 transition-colors cursor-pointer add-comparison-item">
                                        <i class="fa fa-plus-circle text-2xl text-gray-500 hover:text-primary"></i>
                                    </div>
                                </div>
                            </div>
                            <!-- 产品选择模态窗口 -->
                            <div id="product-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
                                <div class="bg-dark-light rounded-xl w-full max-w-2xl max-h-[80vh] overflow-hidden flex flex-col">
                                    <div class="p-5 border-b border-gray-800 flex justify-between items-center">
                                        <h3 class="text-xl font-bold text-white">选择产品</h3>
                                        <button id="close-modal" class="text-gray-400 hover:text-white">
                                            <i class="fa fa-times text-xl"></i>
                                        </button>
                                    </div>
                                    <div class="p-5 overflow-y-auto flex-1">
                                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" id="modal-product-list">
                                            <!-- 产品列表将通过JavaScript动态生成 -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-dark-light rounded-lg p-5 border border-gray-800">
                                <h4 class="text-lg font-semibold text-white mb-4">选择对比指标</h4>
                                <div class="space-y-3">
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" checked class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">感知精度 (%)</span>
                                    </label>
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" checked class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">算力消耗 (TOPS)</span>
                                    </label>
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" checked class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">响应延迟 (ms)</span>
                                    </label>
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">功耗 (W)</span>
                                    </label>
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">工作温度范围 (°C)</span>
                                    </label>
                                    <label class="flex items-center gap-2 p-2 hover:bg-dark rounded transition-colors">
                                        <input type="checkbox" class="rounded text-primary focus:ring-primary">
                                        <span class="text-gray-200">成本效益比</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- 对比图表区域 -->
                        <div class="lg:col-span-2">
                            <div class="bg-dark-light rounded-lg p-5 border border-gray-800 mb-6">
                                <div class="flex justify-between items-center mb-6">
                                    <h4 class="text-lg font-semibold text-white">性能指标雷达图对比</h4>
                                    <div class="flex gap-2">
                                        <button class="p-2 rounded border border-gray-700 hover:border-primary transition-colors text-gray-400 hover:text-primary">
                                            <i class="fa fa-download"></i>
                                        </button>
                                        <button class="p-2 rounded border border-gray-700 hover:border-primary transition-colors text-gray-400 hover:text-primary">
                                            <i class="fa fa-expand"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="h-80">
                                    <canvas id="radarChart"></canvas>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-dark-light rounded-lg p-5 border border-gray-800">
                                    <h4 class="text-lg font-semibold text-white mb-4">感知精度对比</h4>
                                    <div class="h-64">
                                        <canvas id="accuracyChart"></canvas>
                                    </div>
                                </div>
                                <div class="bg-dark-light rounded-lg p-5 border border-gray-800">
                                    <h4 class="text-lg font-semibold text-white mb-4">算力消耗对比</h4>
                                    <div class="h-64">
                                        <canvas id="powerChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 数据仪表盘区域 -->
                <section id="dashboard" class="mb-16">
                    <h3 class="text-2xl font-bold text-white mb-8 flex items-center gap-2">
                        <i class="fa fa-dashboard text-primary"></i> VALEO ADAS智库分析
                    </h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <!-- 数据卡片 1 -->
                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800 hover:border-primary/50 transition-all duration-300">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <p  class="text-gray-400 text-sm">产品总数</p>
                                    <h4 id="product_number_count" class="text-3xl font-bold text-white mt-1">--</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary">
                                    <i class="fa fa-cubes text-xl"></i>
                                </div>
                            </div>
                            <div class="flex items-center gap-1 text-xs text-green-400">
                                <i class="fa fa-arrow-up"></i>
                                <span>12.5% 较上月</span>
                            </div>
                        </div>

                        <!-- 数据卡片 2 -->
                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800 hover:border-primary/50 transition-all duration-300">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <p class="text-gray-400 text-sm">车厂总数</p>
                                    <h4 id="oem_number_count" class="text-3xl font-bold text-white mt-1">--</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center text-secondary">
                                    <i class="fa fa-road text-xl"></i>
                                </div>
                            </div>
                            <div class="flex items-center gap-1 text-xs text-green-400">
                                <i class="fa fa-arrow-up"></i>
                                <span>5.8% 较上月</span>
                            </div>
                        </div>

                        <!-- 数据卡片 3 -->
                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800 hover:border-primary/50 transition-all duration-300">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <p class="text-gray-400 text-sm">平均感知精度</p>
                                    <h4 class="text-3xl font-bold text-white mt-1">96.4%</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-neon-pink/10 flex items-center justify-center text-neon-pink">
                                    <i class="fa fa-eye text-xl"></i>
                                </div>
                            </div>
                            <div class="flex items-center gap-1 text-xs text-green-400">
                                <i class="fa fa-arrow-up"></i>
                                <span>2.1% 较上月</span>
                            </div>
                        </div>

                        <!-- 数据卡片 4 -->
                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800 hover:border-primary/50 transition-all duration-300">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <p class="text-gray-400 text-sm">测试数据量</p>
                                    <h4 class="text-3xl font-bold text-white mt-1">1.2 PB</h4>
                                </div>
                                <div class="w-12 h-12 rounded-full bg-neon-yellow/10 flex items-center justify-center text-neon-yellow">
                                    <i class="fa fa-database text-xl"></i>
                                </div>
                            </div>
                            <div class="flex items-center gap-1 text-xs text-green-400">
                                <i class="fa fa-arrow-up"></i>
                                <span>28.3% 较上月</span>
                            </div>
                        </div>
                    </div>

                    <!-- 趋势图表 -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800">
                            <div class="flex justify-between items-center mb-6">
                                <h4 class="text-lg font-semibold text-white">ADAS技术发展趋势</h4>
                                <div class="flex gap-2">
                                    <button class="px-3 py-1 text-xs bg-dark rounded-full text-primary">季度</button>
                                    <button class="px-3 py-1 text-xs bg-dark rounded-full text-gray-400 hover:text-primary">年度</button>
                                </div>
                            </div>
                            <div class="h-64">
                                <canvas id="trendChart"></canvas>
                            </div>
                        </div>

                        <div class="bg-dark-light rounded-lg p-5 border border-gray-800">
                            <div class="flex justify-between items-center mb-6">
                                <h4 class="text-lg font-semibold text-white">厂商市场份额</h4>
                                <button class="text-gray-400 hover:text-primary text-sm">
                                    <i class="fa fa-ellipsis-v"></i>
                                </button>
                            </div>
                            <div class="h-64">
                                <canvas id="marketShareChart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- 页脚 -->
        <div id="footer-container"></div>   
    </div>
    <!-- JavaScript -->
    <script>
        // 初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            // 雷达图
            const radarCtx = document.getElementById('radarChart').getContext('2d');
            const radarChart = new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['感知精度', '算力消耗', '响应延迟', '环境适应性', '算法效率', '功耗控制'],
                    datasets: [
                        {
                            label: '智能前视摄像头系统',
                            data: [98.7, 85, 92, 88, 95, 76],
                            backgroundColor: 'rgba(0, 240, 255, 0.2)',
                            borderColor: 'rgba(0, 240, 255, 1)',
                            pointBackgroundColor: 'rgba(0, 240, 255, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(0, 240, 255, 1)'
                        },
                        {
                            label: '智能驾驶域控制器',
                            data: [96.5, 92, 88, 90, 93, 68],
                            backgroundColor: 'rgba(255, 42, 109, 0.2)',
                            borderColor: 'rgba(255, 42, 109, 1)',
                            pointBackgroundColor: 'rgba(255, 42, 109, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(255, 42, 109, 1)'
                        }
                    ]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            pointLabels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.5)',
                                backdropColor: 'transparent'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, a255, 255, 0.7)'
                            }
                        }
                    }
                }
            });

            // 感知精度对比图
            const accuracyCtx = document.getElementById('accuracyChart').getContext('2d');
            const accuracyChart = new Chart(accuracyCtx, {
                type: 'bar',
                data: {
                    labels: ['城市道路', '高速公路', '乡村道路', '夜间环境', '恶劣天气'],
                    datasets: [
                        {
                            label: '智能前视摄像头系统',
                            data: [98.2, 99.1, 96.8, 95.3, 92.7],
                            backgroundColor: 'rgba(0, 240, 255, 0.7)'
                        },
                        {
                            label: '智能驾驶域控制器',
                            data: [97.5, 98.7, 95.9, 94.8, 93.2],
                            backgroundColor: 'rgba(255, 42, 109, 0.7)'
                        }
                    ]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });

            // 算力消耗对比图
            const powerCtx = document.getElementById('powerChart').getContext('2d');
            const powerChart = new Chart(powerCtx, {
                type: 'bar',
                data: {
                    labels: ['目标检测', '车道线识别', '语义分割', '路径规划', '多传感器融合'],
                    datasets: [
                        {
                            label: '智能前视摄像头系统',
                            data: [32, 28, 45, 18, 38],
                            backgroundColor: 'rgba(0, 240, 255, 0.7)'
                        },
                        {
                            label: '智能驾驶域控制器',
                            data: [45, 38, 62, 32, 55],
                            backgroundColor: 'rgba(255, 42, 109, 0.7)'
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                callback: function(value) {
                                    return value + ' TOPS';
                                }
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });

            // 趋势图
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            const trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['Q1 2022', 'Q2 2022', 'Q3 2022', 'Q4 2022', 'Q1 2023', 'Q2 2023'],
                    datasets: [
                        {
                            label: '感知精度 (%)',
                            data: [92.3, 93.8, 94.5, 95.2, 95.9, 96.4],
                            borderColor: 'rgba(0, 240, 255, 1)',
                            backgroundColor: 'rgba(0, 240, 255, 0.1)',
                            tension: 0.3,
                            fill: true
                        },
                        {
                            label: '算力提升 (TOPS)',
                            data: [45, 58, 72, 95, 156, 254],
                            borderColor: 'rgba(121, 40, 202, 1)',
                            backgroundColor: 'rgba(121, 40, 202, 0.1)',
                            tension: 0.3,
                            fill: true
                        }
                    ]
                },
                options: {
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            },
                            ticks: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)'
                            }
                        }
                    }
                }
            });

            // 市场份额饼图
            const marketShareCtx = document.getElementById('marketShareChart').getContext('2d');
            const marketShareChart = new Chart(marketShareCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Mobileye', 'NVIDIA', 'Bosch', 'Continental', '其他'],
                    datasets: [
                        {
                            data: [35, 28, 15, 12, 10],
                            backgroundColor: [
                                'rgba(0, 240, 255, 0.7)',
                                'rgba(255, 42, 109, 0.7)',
                                'rgba(121, 40, 202, 0.7)',
                                'rgba(254, 202, 87, 0.7)',
                                'rgba(100, 100, 100, 0.7)'
                            ],
                            borderWidth: 0
                        }
                    ]
                },
                options: {
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: 'rgba(255, 255, 255, 0.7)',
                                padding: 15
                            }
                        }
                    },
                    cutout: '65%'
                }
            });
        });
    
        document.addEventListener('DOMContentLoaded',()=>{
            let allcards = {}
            let nonhiddencards = {}
            let allproduct = {}
            let alloem = {}
            let productArray =[]
            loadProducts();
            document.getElementById('brand-filter').addEventListener('change', applyFilters);
            //初始化加载数据库
            function loadProducts(){    //初始化加载数据库
                // 显示加载状态
                document.getElementById('product-grid').innerHTML = '<div class="col-span-full text-center py-10"><i class="fa fa-spinner fa-spin text-primary text-3xl"></i></div>';

                fetch('api/launchtrying',{
                    method:'POST',
                    headers:{
                        'Content-Type':'application/json'
                    },
                    body:JSON.stringify({
                        scriptName:'parse_adas_benchmark'
                    })
                })
                .then(response =>{
                    if (!response.ok) {
                        throw new Error(`HTTP错误: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data =>{
                    if(data.success){
                        const answer = JSON.parse(data.output);
                        const products = answer.result
                        allproduct = products
                        const oemlist = answer.oem_array
                        alloem = oemlist
                            // 生成产品卡片
                        renderProducts(products);
                        allcards = document.querySelectorAll('.veh-card');
                        nonhiddencards = document.querySelectorAll('.veh-card:not(.hidden)');
                        displayviewcards(nonhiddencards)
                        summerizeupdate()
                        populateFilters(oemlist);
                        initComparisonFeature()
                    }
                    else{
                        console.log("没有收到数据");
                        document.getElementById('product-grid').innerHTML = '<div class="col-span-full text-center py-10 text-gray-400">没有找到产品数据</div>';
                    }
                })
                .catch(error => {
                    console.error("请求过程中出错:", error);
                    document.getElementById('product-grid').innerHTML = '<div class="col-span-full text-center py-10 text-gray-400">加载失败，请稍后重试</div>';
                })
            }
            
            function displayviewcards(nonhiddencards){
                // const cardsnumber = allcards.length;
                const simpleshowcase = 4;
                nonhiddennumber = nonhiddencards.length
                cardindex = 0;
                
                if(nonhiddennumber >simpleshowcase){
                    nonhiddencards.forEach(card => {
                        cardindex++
                        if(cardindex>simpleshowcase){
                            card.classList.add('hidden')
                        }
                    })
                }
                loadbuttondefine()
            }

            function loadbuttondefine(){  //按钮切换
                nonhidden_needed_cards = document.querySelectorAll('.veh-card:not(.hidden):not(.filout)');
                total_needed_cards = document.querySelectorAll('.veh-card:not(.filout)');
                displaygap = total_needed_cards.length - nonhidden_needed_cards.length

                if(total_needed_cards.length > 4 && displaygap>0){    //需要展示的内容大于4个，且没有展示完全，则展示更多
                    document.getElementById('load-more').style.display = 'inline-flex';
                    document.getElementById('load-more').innerHTML ='<i class="fa fa-refresh"></i> 加载更多内容';
                }
                else if(nonhidden_needed_cards.length>4){ // 展示内容大于4个
                    document.getElementById('load-more').style.display = 'inline-flex';
                    document.getElementById('load-more').innerHTML = '<i class="fa fa-refresh"></i> 展示部分';
                }
                else{
                    document.getElementById('load-more').style.display = 'none';
                }

            }

            // 生成产品卡片
            function renderProducts(products) {   // 生成产品卡片

                const productGrid = document.getElementById('product-grid');
                productGrid.innerHTML = '';

                // 检查products是否是有效的对象
                if (!products || typeof products !== 'object') {
                    productGrid.innerHTML = '<div class="col-span-full text-center py-10 text-gray-400">数据格式无效</div>';
                    return;
                }

                // 转换对象为数组
                productArray = Object.entries(products).map(([key, value]) => ({
                    id: key,
                    ...value
                }));

                // 只显示前4个产品
                const initialProducts = productArray;

                // 保存完整产品列表
                productGrid.dataset.allProducts = JSON.stringify(productArray);

                // 生成产品卡片
                productArray.forEach(product => {
                    const card = createProductCard(product);
                    productGrid.appendChild(card);
                });
            }
        
            // 创建单个产品卡片
            function createProductCard(product) {  //创建单个产品卡片
                // 提取产品信息

                const name = product.id || '未知产品';
                const version = product.PROP?.YEAR || 'v1.0.0';
                const description = product.PROP?.DESCRIPTION || '暂无描述';
                const rating = product.PROP?.RATING || 0;
                const reviewCount = product.PROP?.REVIEW_COUNT || 0;
                const brand = product.PROP?.BRAND || '未知品牌';
                const productname = product.PROP?.PRODUCT_NAME || '未知产品';
                const productlevel = product.PROP?.PERFORMANCE.SAE ||"未知级别"
                const productresource = product.PROP?.PERFORMANCE.RESOURCE ||"未知资源"
                const feature1 = product.PROP?.SENSOR.STATISTICS.TOTAL || '特性1';
                const feature2 = product.PROP?.ECU_INFO.SOC_MCU || '特性2';
                const feature1Label = 'SensorSet';
                const feature2Label = 'Calculator'
                isnew = 0;
                
                if (version == 2024) {
                    isnew = 1;
                }
                // 创建卡片元素
                const card = document.createElement('div');
                card.className = 'veh-card bg-dark-light rounded-xl overflow-hidden border border-gray-800 hover:border-primary/50 transition-all duration-300 hover:shadow-lg hover:shadow-primary/10 group';
                card.id = product.id
                // 卡片内容
                card.innerHTML = `
                    <div class="relative h-40 bg-dark overflow-hidden">
                        <img src="../PIC/${name}.png" alt="${name}" class="w-full h-full object-cover opacity-100 group-hover:scale-105 transition-transform duration-500">
                        ${isnew ? '<div class="absolute top-3 right-3 bg-neon-pink text-white text-xs font-bold px-2 py-1 rounded">新品</div>' : ''}
                    </div>
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-3">
                            <h4 class="text-lg font-semibold text-white group-hover:text-primary transition-colors">${name}</h4>
                            <span class="text-primary font-mono">${version}</span>
                        </div>
                        <p class="text-gray-400 text-sm mb-4 line-clamp-2">${brand}</p>
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex items-center gap-1">
                                <i class="fa fa-star text-yellow-400"></i>
                                <span class="text-white font-bold">${productlevel}</span>
                                <span class="text-white text-sm">(${productresource} TOPS)</span>
                            </div>
                            <span class="text-xs bg-gray-800 px-2 py-1 rounded-full">${productname}</span>
                        </div>
                        <div class="grid grid-cols-[40%_60%] gap-2 text-xs mb-5">
                            <div class="bg-dark/50 rounded p-2">
                                <div class="text-gray-400 mb-1">${feature1Label}</div>
                                <div class="text-white flex items-center gap-1">
                                    <i class="fa fa-check text-primary"></i> ${feature1}
                                </div>
                            </div>
                            <div class="bg-dark/50 rounded p-2">
                                <div class="text-gray-400 mb-1">${feature2Label}</div>
                                <div class="text-white flex items-center gap-1">
                                    <i class="fa fa-check text-primary"></i> ${feature2}
                                </div>
                            </div>
                        </div>
                        <button class="w-full py-2 rounded border border-primary text-primary hover:bg-primary/10 transition-all duration-300 text-sm">
                            查看详情
                        </button>
                    </div>
                `;

                return card;
            }
        
            // 填充筛选选项
            function populateFilters(brands) {   // 填充筛选选项
                // 提取所有类别和品牌
                const categories = new Set();
                // const brands = new Set();

                // products.forEach(product => {
                //     // 假设类别信息在PRODUCT_TYPE字段
                //     if (product.PROP?.PRODUCT_TYPE) {
                //         categories.add(product.PROP.PRODUCT_TYPE);
                //     }
                //     // 品牌信息在BRAND字段
                //     if (product.PROP?.BRAND) {
                //         brands.add(product.PROP.BRAND);
                //     }
                // });

                // 填充类别筛选器
                // const categoryFilter = document.getElementById('category-filter');
                // categoryFilter.innerHTML = '<option value="all">所有类别</option>';
                // categories.forEach(category => {
                //     const option = document.createElement('option');
                //     option.value = category;
                //     option.textContent = category;
                //     categoryFilter.appendChild(option);
                // });

                // 填充品牌筛选器
                const brandFilter = document.getElementById('brand-filter');
                brandFilter.innerHTML = '<option value="all">所有品牌</option>';
                brands.forEach(brand => {
                    const option = document.createElement('option');
                    option.value = brand;
                    option.textContent = brand;
                    brandFilter.appendChild(option);
                });
            }
            
            // 应用筛选
            function applyFilters() {
                const productGrid = document.getElementById('product-grid');
                const allProducts = JSON.parse(productGrid.dataset.allProducts || '[]');
                const searchTerm = document.getElementById('search-input').value.toLowerCase();
                const category = document.getElementById('category-filter').value;
                const brand = document.getElementById('brand-filter').value;

                // 筛选产品
                const filteredProducts = allProducts.filter(product => {
                    // 搜索词筛选
                    const matchesSearch = product.id.toLowerCase().includes(searchTerm) ||
                                        (product.PROP?.PRODUCT_NAME && product.PROP.PRODUCT_NAME.toLowerCase().includes(searchTerm)) ||
                                        (product.PROP?.DESCRIPTION && product.PROP.DESCRIPTION.toLowerCase().includes(searchTerm));

                    // // 类别筛选
                    // const matchesCategory = category === 'all' ||
                    //                     (product.PROP?.PRODUCT_TYPE && product.PROP.PRODUCT_TYPE === category);

                    // 品牌筛选
                    const matchesBrand = brand === 'all' ||
                                    (product.PROP?.BRAND && product.PROP.BRAND === brand);

                    currentcard = document.getElementById(product.id)
                    if (!(matchesSearch && matchesBrand)){

                        currentcard.classList.add('hidden')
                        currentcard.classList.add('filout')
                    }else{
                        currentcard.classList.remove('hidden')
                        currentcard.classList.remove('filout')
                    }
                    return matchesSearch && matchesBrand;
                });

                loadbuttondefine()


                // // 显示筛选结果
                // productGrid.innerHTML = '';
                // if (filteredProducts.length === 0) {
                //     productGrid.innerHTML = '<div class="col-span-full text-center py-10 text-gray-400">没有找到匹配的产品</div>';
                //     document.getElementById('load-more').style.display = 'none';
                // } else {
                //     // 只显示前4个产品
                //     const initialProducts = filteredProducts.slice(0, 4);
                //     initialProducts.forEach(product => {
                //         const card = createProductCard(product);
                //         productGrid.appendChild(card);
                //     });

                //     // 更新完整产品列表
                //     productGrid.dataset.allProducts = JSON.stringify(filteredProducts);

                //     // 控制加载更多按钮
                //     const loadMoreBtn = document.getElementById('load-more');
                //     if (filteredProducts.length > 4) {
                //         loadMoreBtn.style.display = 'inline-flex';
                //         loadMoreBtn.innerHTML = '<i class="fa fa-refresh"></i> 加载更多产品';
                //     } else {
                //         loadMoreBtn.style.display = 'none';
                //     }
                // }
            }
            
            // 初始化对比产品功能
            function initComparisonFeature() {
                // 模态窗口元素
                const modal = document.getElementById('product-modal');
                const modalProductList = document.getElementById('modal-product-list');
                const closeModalBtn = document.getElementById('close-modal');
                const comparisonContainer = document.getElementById('comparison-products');

                // 打开模态窗口
                document.addEventListener('click', function(e) {
                    if (e.target.closest('.add-comparison-item')) {
                        openProductModal();
                    }
                });

                // 关闭模态窗口
                closeModalBtn.addEventListener('click', function() {
                    modal.classList.add('hidden');
                });

                // 点击模态窗口外部关闭
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        modal.classList.add('hidden');
                    }
                });

                // 打开产品选择模态窗口
                function openProductModal() {
                    // 清空产品列表
                    modalProductList.innerHTML = '';
                    // 检查是否有产品数据
                    if (!productArray) {
                        modalProductList.innerHTML = '<div class="col-span-2 text-center py-10 text-gray-400">没有产品数据</div>';
                        modal.classList.remove('hidden');
                        return;
                    }

                    // 将产品对象转换为数组
                    const products = Object.values(allproduct);
                    console.log("Here is the motherfucker",productArray)
                    // 生成产品列表
                    productArray.forEach(product => {
                        
                        const productItem = createModalProductItem(product);
                        modalProductList.appendChild(productItem);
                    });

                    // 显示模态窗口
                    modal.classList.remove('hidden');
                }

                // 创建模态窗口中的产品项
                function createModalProductItem(product) {
                    const name = product.id || '未知产品';
                    const brand = product.PROP?.BRAND || '未知品牌';
                    const imageUrl = `PIC/${name}.png`;

                    const item = document.createElement('div');
                    item.className = 'bg-dark rounded-lg border border-gray-800 p-3 hover:border-primary/50 cursor-pointer transition-colors';
                    item.innerHTML = `
                        <div class="flex items-center gap-3">
                            <img src="${imageUrl}" alt="${name}" class="w-15 h-12 rounded object-cover">
                            <div class="flex-1 min-w-0">
                                <h5 class="text-white font-medium truncate">${name}</h5>
                                <p class="text-xs text-gray-400">${brand}</p>
                            </div>
                        </div>
                    `;

                    // 点击产品项添加到对比
                    item.addEventListener('click', function() {
                        addProductToComparison(product);
                        document.getElementById('product-modal').classList.add('hidden');
                    });

                    return item;
                }

                // 添加产品到对比面板
                function addProductToComparison(product) {
                    const name = product.id || '未知产品';
                    const brand = product.PROP?.BRAND || '未知品牌';
                    const imageUrl = `PIC/${name}.png`;

                    // 创建对比产品项
                    const productItem = document.createElement('div');
                    productItem.className = 'compare-item flex items-center gap-3 p-3 bg-dark rounded-lg border border-primary/30';
                    productItem.innerHTML = `
                        <img src="${imageUrl}" alt="${name}" class="w-15 h-12 rounded object-cover">
                        <div class="flex-1 min-w-0">
                            <h5 class="text-white font-medium truncate">${name}</h5>
                            <p class="text-xs text-gray-400">${brand}</p>
                        </div>
                        <button class="text-gray-400 hover:text-primary remove-comparison-item">
                            <i class="fa fa-times-circle"></i>
                        </button>
                    `;

                    // 添加删除功能
                    productItem.querySelector('.remove-comparison-item').addEventListener('click', function() {
                        productItem.remove();
                        // 如果对比容器为空，添加一个添加框
                        if (comparisonContainer.children.length === 0) {
                            addEmptyComparisonItem();
                        }
                    });

                    // 移除现有的添加框（如果存在）
                    const emptyItem = comparisonContainer.querySelector('.add-comparison-item');
                    if (emptyItem) {
                        emptyItem.remove();
                    }

                    // 添加新产品项
                    comparisonContainer.appendChild(productItem);

                    // 添加一个新的添加框

                    if(document.querySelectorAll('.compare-item').length<3){
                    addEmptyComparisonItem();
                    }
                }

                // 添加空的对比项（用于添加新产品）
                function addEmptyComparisonItem() {
                    console.log("我就是我，使眼色不一样的烟火")
                    const emptyItem = document.createElement('div');
                    emptyItem.className = 'compare-item flex items-center justify-center p-6 bg-dark rounded-lg border border-dashed border-gray-700 hover:border-primary/50 transition-colors cursor-pointer add-comparison-item';
                    emptyItem.innerHTML = '<i class="fa fa-plus-circle text-2xl text-gray-500 hover:text-primary"></i>';
                    comparisonContainer.appendChild(emptyItem);
                }
            }
            //智库信息汇总
            function summerizeupdate(){
                document.getElementById("product_number_count").textContent = allcards.length;
                document.getElementById("oem_number_count").textContent = alloem.length;

            }

            // 加载更多按钮点击事件
            document.getElementById('load-more').addEventListener('click', function() {     // 加载更多按钮点击事件
                nonhidden_needed_cards = document.querySelectorAll('.veh-card:not(.hidden):not(.filout)');
                hidden_neede_cards = document.querySelectorAll('.veh-card.hidden:not(.filout)');
                // 检查当前是否显示全部产品
                if (this.textContent.includes('加载更多内容')) {
                    // 显示全部产品
                    hidden_neede_cards.forEach(card =>{
                        card.classList.remove('hidden');
                    })
                    loadbuttondefine()
                } else if(this.textContent.includes('展示部分')){
                    // 显示部分产品
                    displayviewcards(nonhidden_needed_cards)
                    // 更改按钮文本
                }
                });
            });
    
    </script>

        <!-- 加载组件的脚本 -->
    <script src="../js/load-components.js"></script>
</body>
</html>
